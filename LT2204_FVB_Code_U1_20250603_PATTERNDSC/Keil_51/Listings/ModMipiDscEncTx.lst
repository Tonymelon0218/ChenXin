C51 COMPILER V9.60.0.0   MODMIPIDSCENCTX                                                   11/11/2025 13:52:36 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MODMIPIDSCENCTX
OBJECT MODULE PLACED IN .\Objects\ModMipiDscEncTx.obj
COMPILER INVOKED BY: D:\DevTools\Keil_5\Keil_v5\C51\BIN\C51.EXE ..\User\L1_Module\ModMipiDscEncTx.c LARGE OBJECTADVANCED
                    - OPTIMIZE(11,SIZE) REGFILE(.\Objects\LT6911GXD_Pattern_MIPI_3D_NoBurst_4320x2160@90_25111103.ORC) BROWSE INCDIR(..\User\
                    -L0_App;..\User\L1_Module;..\User\L2_Drive;..\User\L3_Ocm) DEBUG PRINT(.\Listings\ModMipiDscEncTx.lst) OBJECT(.\Objects\M
                    -odMipiDscEncTx.obj)

line level    source

   1          /******************************************************************************
   2            * @project: LT2204
   3            * @file: ModMipiDscEncTx.c
   4            * @author: wtt
   5            * @company: LONTIUM
   6            * @date: 2022.05.26
   7          /******************************************************************************/
   8          #include "include.h"
   9          
  10          #if TX_PORT_SIGN == MIPI_PORT
  11          #if MIPITX_DSC == ENABLED
  12          
  13          code u8 ucuzEncPPS[128] = {
  14              // 2280*2280 90
  15              //          0x11,0x00,0x00,0x89,0x10,0x80,0x08,0x70,0x08,0x70,0x00,0x08,0x02,0x1C,0x02,0x1C,
  16              //          0x02,0x00,0x02,0x0E,0x00,0x20,0x00,0xBB,0x00,0x07,0x00,0x0C,0x0D,0xB7,0x0C,0xB7,
  17              //          0x18,0x00,0x10,0xF0,0x03,0x0C,0x20,0x00,0x06,0x0B,0x0B,0x33,0x0E,0x1C,0x2A,0x38,
  18              //          0x46,0x54,0x62,0x69,0x70,0x77,0x79,0x7B,0x7D,0x7E,0x01,0x02,0x01,0x00,0x09,0x40,
  19              //          0x09,0xBE,0x19,0xFC,0x19,0xFA,0x19,0xF8,0x1A,0x38,0x1A,0x78,0x1A,0xB6,0x2A,0xF6,
  20              //          0x2B,0x34,0x2B,0x74,0x3B,0x74,0x6B,0xF4,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  21              //    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  22              //    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  23          
  24              // ofg application 4560*2280 90
  25              //    0x11,0x00,0x00,0x89,0x30,0x80,0x08,0xE8,0x11,0xD0,0x00,0x28,0x04,0x74,0x04,0x74,
  26              //    0x02,0x00,0x03,0x3A,0x00,0x20,0x05,0x45,0x00,0x0F,0x00,0x0C,0x02,0x77,0x01,0x35,
  27              //    0x18,0x00,0x10,0xF0,0x03,0x0c,0x20,0x00,0x06,0x0b,0x0b,0x33,0x0e,0x1c,0x2a,0x38,
  28              //    0x46,0x54,0x62,0x69,0x70,0x77,0x79,0x7b,0x7d,0x7e,0x01,0x02,0x01,0x00,0x09,0x40,
  29              //    0x09,0xbe,0x19,0xfc,0x19,0xfa,0x19,0xf8,0x1a,0x38,0x1a,0x78,0x1a,0xb6,0x2a,0xf6,
  30              //    0x2b,0x34,0x2b,0x74,0x3b,0x74,0x6b,0xF4,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  31              //    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  32              //    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  33          
  34              // 3552X3840
  35              //  0x11,0x0,0x0,0x89,0x30,0x80,0xf,0x0,0xd,0xe0,0x7,0x80,0x3,0x78,0x3,0x78,
  36              //  0x2,0x0,0x3,0x2b,0x0,0x20,0xbe,0x97,0x0,0xc,0x0,0xf,0x0,0x11,0x0,0x9,
  37              //  0x18,0x0,0x10,0xf0,0x3,0xc,0x20,0x0,0x6,0xb,0xb,0x33,0xe,0x1c,0x2a,0x38,
  38              //  0x46,0x54,0x62,0x69,0x70,0x77,0x79,0x7b,0x7d,0x7e,0x1,0x2,0x1,0x0,0x9,0x40,
  39              //  0x9,0xbe,0x19,0xfc,0x19,0xfa,0x19,0xf8,0x1a,0x38,0x1a,0x78,0x22,0xb6,0x2a,0xb6,
  40              //  0x2a,0xf6,0x2a,0xf4,0x43,0x34,0x63,0x74,0x0,0x0,0x0,0x0,0x0,0x0,0x00,0x00,
  41              //  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  42              //  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  43          
  44              // 2160x2160@90         0x30
  45              // 0x11, 0x00, 0x00, 0x89, 0x30, 0x80, 0x08, 0x70, 0x08, 0x70, 0x00, 0x10, 0x02, 0x1C, 0x02, 0x1C,
  46              // 0x02, 0x00, 0x02, 0x0E, 0x00, 0x20, 0x01, 0x84, 0x00, 0x07, 0x00, 0x0C, 0x06, 0x67, 0x06, 0x5C,
  47              // 0x18, 0x00, 0x10, 0xF0, 0x03, 0x0C, 0x20, 0x00, 0x06, 0x0B, 0x0B, 0x33, 0x0E, 0x1C, 0x2A, 0x38,
  48              // 0x46, 0x54, 0x62, 0x69, 0x70, 0x77, 0x79, 0x7B, 0x7D, 0x7E, 0x01, 0x02, 0x01, 0x00, 0x09, 0x40,
  49              // 0x09, 0xBE, 0x19, 0xFC, 0x19, 0xFA, 0x19, 0xF8, 0x1A, 0x38, 0x1A, 0x78, 0x1A, 0xB6, 0x2A, 0xF6,
  50              // 0x2B, 0x34, 0x2B, 0x74, 0x3B, 0x74, 0x6B, 0xF4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00,
  51              // 0x00, 0x89, 0x30, 0x80, 0x08, 0x70, 0x08, 0x70, 0x00, 0x10, 0x02, 0x1C, 0x02, 0x1C, 0x03, 0x52,
  52              // 0x02, 0x0E, 0x00, 0x20, 0x00, 0x00, 0x00, 0x07, 0x00, 0x0C, 0x06, 0x67, 0x06, 0x5C, 0x18, 0x00,
C51 COMPILER V9.60.0.0   MODMIPIDSCENCTX                                                   11/11/2025 13:52:36 PAGE 2   

  53          
  54              // 4320x2160@90                     0x08, 0x70, 0x08, 0x70
  55              0x11, 0x00, 0x00, 0x89, 0x10, 0x80, 0x08, 0x70, 0x10, 0xE0, 0x00, 0x10, 0x02, 0x1C, 0x02, 0x1C,
  56              0x02, 0x00, 0x02, 0x0E, 0x00, 0x20, 0x01, 0x84, 0x00, 0x07, 0x00, 0x0C, 0x06, 0x67, 0x06, 0x5C,
  57              0x18, 0x00, 0x10, 0xF0, 0x03, 0x0C, 0x20, 0x00, 0x06, 0x0B, 0x0B, 0x33, 0x0E, 0x1C, 0x2A, 0x38,
  58              0x46, 0x54, 0x62, 0x69, 0x70, 0x77, 0x79, 0x7B, 0x7D, 0x7E, 0x01, 0x02, 0x01, 0x00, 0x09, 0x40,
  59              0x09, 0xBE, 0x19, 0xFC, 0x19, 0xFA, 0x19, 0xF8, 0x1A, 0x38, 0x1A, 0x78, 0x1A, 0xB6, 0x2A, 0xF6,
  60              0x2B, 0x34, 0x2B, 0x74, 0x3B, 0x74, 0x6B, 0xF4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00,
  61              0x00, 0x89, 0x30, 0x80, 0x08, 0x70, 0x08, 0x70, 0x00, 0x10, 0x02, 0x1C, 0x02, 0x1C, 0x03, 0x52,
  62              0x02, 0x0E, 0x00, 0x20, 0x00, 0x00, 0x00, 0x07, 0x00, 0x0C, 0x06, 0x67, 0x06, 0x5C, 0x18, 0x00
  63          };
  64          void Mod_MipiTxDscEnc_PpsParaInit()
  65          {
  66   1          memset(&g_stMipiTxDscEncConfig, 0, sizeof(DSCConfig_Stru));
  67   1          g_stMipiTxDscEncConfig.ucSliceNum = 8;  // 2D->4; 3D->8
  68   1          g_stMipiTxDscEncConfig.ucDscNumber = 8; // 2D->4; 3D->8
  69   1          g_stMipiTxDscEncConfig.ucExtraHact = 0;
  70   1          g_stMipiTxDscEncConfig.ucColorDepth = BPC8;
  71   1          g_stMipiTxDscEncConfig.ucCompressRatio = 3;
  72   1          g_stMipiTxDscEncConfig.ucOutBpp = 8;
  73   1          g_stMipiTxDscEncConfig.usSliceHeight = ((u16)ucuzEncPPS[10] << 8) + ucuzEncPPS[11];
  74   1          g_stMipiTxDscEncConfig.usSliceWidth = ((u16)ucuzEncPPS[12] << 8) + ucuzEncPPS[13];
  75   1          g_stMipiTxDscEncConfig.usChunkSize = ((u16)ucuzEncPPS[14] << 8) + ucuzEncPPS[15];
  76   1          LTLog(LOG_DEBUG, "DscEnc Slice = %bd,CompressRatio = %bd", g_stMipiTxDscEncConfig.ucSliceNum, g_stMipi
             -TxDscEncConfig.ucCompressRatio);
  77   1          LTLog(LOG_DEBUG, "DscEnc SliceHeight = %d,SliceWidth = %d,ChunkSize = %d", g_stMipiTxDscEncConfig.usSl
             -iceHeight, g_stMipiTxDscEncConfig.usSliceWidth, g_stMipiTxDscEncConfig.usChunkSize);
  78   1      }
  79          
  80          void Mod_MipiTxDscEnc_Clk_Chk(void)
  81          {
  82   1          u32 TempClock;
  83   1      
  84   1          Drv_System_FmSet(TOP_FM, 0x0F);
  85   1          Ocm_Delay1ms(5);
  86   1          TempClock = Drv_System_FmGet(TOP_FM, 0);
  87   1          LTLog(LOG_INFO, "Ad_csctx_half_pix_clk = %lukhz", TempClock);
  88   1      
  89   1          Drv_System_FmSet(TOP_FM, 0x12);
  90   1          Ocm_Delay1ms(5);
  91   1          TempClock = Drv_System_FmGet(TOP_FM, 0);
  92   1          LTLog(LOG_INFO, "Ad_dsctx_dsc_rd_clk = %lukhz", TempClock);
  93   1      
  94   1          Drv_System_FmSet(TOP_FM, 0x13);
  95   1          Ocm_Delay1ms(50);
  96   1          TempClock = Drv_System_FmGet(TOP_FM, 0);
  97   1          LTLog(LOG_INFO, "Ad_dsctx_dsc_clk = %lukhz", TempClock);
  98   1      
  99   1          Drv_System_FmSet(TOP_FM, 0x14);
 100   1          Ocm_Delay1ms(5);
 101   1          TempClock = Drv_System_FmGet(TOP_FM, 0);
 102   1          LTLog(LOG_INFO, "Ad_dsctx_dsc_out_clk = %lukhz", TempClock);
 103   1      }
 104          
 105          void Mod_MipiTxDscEnc_ModuleEnable(void)
 106          {
 107   1          Drv_MipiTxDscEnc_DataMux();
 108   1      #if (MIPITX_VID_PATTERN_MODE != NO_PATTERN)
 109   1          Drv_MipiTxDscEnc_ClkMuxForPattern();
 110   1      #else
                  Drv_MipiTxDscEnc_ClkMux();
              #endif
C51 COMPILER V9.60.0.0   MODMIPIDSCENCTX                                                   11/11/2025 13:52:36 PAGE 3   

 113   1          Drv_MipiTxDscEnc_RxParamSet();
 114   1          Drv_MipiTxDscEnc_ExtraHactSet();
 115   1          Drv_MipiTxDscEnc_TimingSet();
 116   1          Drv_MipiTxDscEnc_MuxWordDly();
 117   1          Drv_MipiTxDscEnc_PpsSet(ucuzEncPPS);
 118   1          Drv_MipiTxDscEnc_ColorSpaceSet();
 119   1          Drv_MipiTxDscEnc_PpsDynamicSet();
 120   1          Drv_MipiTxDscEnc_ParamSet();
 121   1      }
 122          
 123          void Mod_MipiTxDscEnc_Config()
 124          {
 125   1      #if (MIPITX_VID_PATTERN_MODE != NO_PATTERN)
 126   1          Drv_MipiTxDscEnc_InitForPattern();
 127   1      #else
                  Drv_MipiTxDscEnc_Init();
              #endif
 130   1          Mod_MipiTxDscEnc_PpsParaInit();
 131   1          Drv_MipiTxDscEnc_InfoGet();
 132   1          Mod_MipiTxDscEnc_ModuleEnable();
 133   1          Mod_MipiTxDscEnc_Clk_Chk();
 134   1      }
 135          
 136          #endif
 137          #endif


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    444    ----
   CONSTANT SIZE    =    338    ----
   XDATA SIZE       =   ----       4
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
